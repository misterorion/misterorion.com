{"version":3,"file":"inject-partytown-snippet.js","names":["injectPartytownSnippet","collectedScripts","length","existingSnippet","document","querySelector","existingSandbox","remove","forwards","getForwards","snippet","createElement","dataset","partytown","innerHTML","partytownSnippet","forward","head","appendChild"],"sources":["../../../../src/internal-plugins/partytown/utils/inject-partytown-snippet.ts"],"sourcesContent":["import { partytownSnippet } from \"@builder.io/partytown/integration\"\nimport { ScriptProps } from \"gatsby-script\"\nimport { getForwards } from \"./get-forwards\"\n\n// Adapted from https://github.com/BuilderIO/partytown/blob/main/src/react/snippet.tsx to only include CSR logic\nexport function injectPartytownSnippet(\n  collectedScripts: Array<ScriptProps>\n): void {\n  if (!collectedScripts.length) {\n    return\n  }\n\n  const existingSnippet = document.querySelector(`script[data-partytown]`)\n  const existingSandbox = document.querySelector(\n    `iframe[src*=\"~partytown/partytown-sandbox-sw\"]`\n  )\n\n  if (existingSnippet) {\n    existingSnippet.remove()\n  }\n\n  if (existingSandbox) {\n    existingSandbox.remove()\n  }\n\n  const forwards = getForwards(collectedScripts)\n\n  const snippet = document.createElement(`script`)\n  snippet.dataset.partytown = ``\n  snippet.innerHTML = partytownSnippet({ forward: forwards })\n  document.head.appendChild(snippet)\n}\n"],"mappings":";;;;;AAAA;;AAEA;;AAEA;AACO,SAASA,sBAAT,CACLC,gBADK,EAEC;EACN,IAAI,CAACA,gBAAgB,CAACC,MAAtB,EAA8B;IAC5B;EACD;;EAED,MAAMC,eAAe,GAAGC,QAAQ,CAACC,aAAT,CAAwB,wBAAxB,CAAxB;EACA,MAAMC,eAAe,GAAGF,QAAQ,CAACC,aAAT,CACrB,gDADqB,CAAxB;;EAIA,IAAIF,eAAJ,EAAqB;IACnBA,eAAe,CAACI,MAAhB;EACD;;EAED,IAAID,eAAJ,EAAqB;IACnBA,eAAe,CAACC,MAAhB;EACD;;EAED,MAAMC,QAAQ,GAAG,IAAAC,wBAAA,EAAYR,gBAAZ,CAAjB;EAEA,MAAMS,OAAO,GAAGN,QAAQ,CAACO,aAAT,CAAwB,QAAxB,CAAhB;EACAD,OAAO,CAACE,OAAR,CAAgBC,SAAhB,GAA6B,EAA7B;EACAH,OAAO,CAACI,SAAR,GAAoB,IAAAC,6BAAA,EAAiB;IAAEC,OAAO,EAAER;EAAX,CAAjB,CAApB;EACAJ,QAAQ,CAACa,IAAT,CAAcC,WAAd,CAA0BR,OAA1B;AACD"}