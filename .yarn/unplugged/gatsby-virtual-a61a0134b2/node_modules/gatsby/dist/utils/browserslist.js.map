{"version":3,"file":"browserslist.js","names":["installedGatsbyVersion","directory","version","require","path","join","parseInt","split","e","undefined","getBrowsersList","fallbackV1","fallbackOthers","map","fallback","config","browserslist","findConfig","defaults","hasES6ModuleSupport","query","length"],"sources":["../../src/utils/browserslist.ts"],"sourcesContent":["import path from \"path\"\nimport browserslist from \"browserslist/node\"\nimport query from \"browserslist\"\n\nconst installedGatsbyVersion = (directory: string): number | undefined => {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const { version } = require(path.join(\n      directory,\n      `node_modules`,\n      `gatsby`,\n      `package.json`\n    ))\n    return parseInt(version.split(`.`)[0], 10)\n  } catch (e) {\n    return undefined\n  }\n}\n\nexport const getBrowsersList = (directory: string): Array<string> => {\n  const fallbackV1 = [`>1%`, `last 2 versions`, `IE >= 9`]\n  let fallbackOthers = [`>0.25%`, `not dead`]\n\n  if (_CFLAGS_.GATSBY_MAJOR === `5`) {\n    fallbackOthers = fallbackOthers.map(\n      fallback => fallback + ` and supports es6-module`\n    )\n  }\n\n  const fallback =\n    installedGatsbyVersion(directory) === 1 ? fallbackV1 : fallbackOthers\n\n  const config = browserslist.findConfig(directory)\n\n  if (config && config.defaults) {\n    return config.defaults\n  }\n\n  return fallback\n}\n\nexport const hasES6ModuleSupport = (directory: string): boolean => {\n  const browserslist = getBrowsersList(directory)\n  return query(browserslist + `, not supports es6-module`).length === 0\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,sBAAsB,GAAIC,SAAD,IAA2C;EACxE,IAAI;IACF;IACA,MAAM;MAAEC;IAAF,IAAcC,OAAO,CAACC,aAAA,CAAKC,IAAL,CAC1BJ,SAD0B,EAEzB,cAFyB,EAGzB,QAHyB,EAIzB,cAJyB,CAAD,CAA3B;;IAMA,OAAOK,QAAQ,CAACJ,OAAO,CAACK,KAAR,CAAe,GAAf,EAAmB,CAAnB,CAAD,EAAwB,EAAxB,CAAf;EACD,CATD,CASE,OAAOC,CAAP,EAAU;IACV,OAAOC,SAAP;EACD;AACF,CAbD;;AAeO,MAAMC,eAAe,GAAIT,SAAD,IAAsC;EACnE,MAAMU,UAAU,GAAG,CAAE,KAAF,EAAS,iBAAT,EAA4B,SAA5B,CAAnB;EACA,IAAIC,cAAc,GAAG,CAAE,QAAF,EAAY,UAAZ,CAArB;;EAEA,IAAI,QAA2B,GAA/B,EAAmC;IACjCA,cAAc,GAAGA,cAAc,CAACC,GAAf,CACfC,QAAQ,IAAIA,QAAQ,GAAI,0BADT,CAAjB;EAGD;;EAED,MAAMA,QAAQ,GACZd,sBAAsB,CAACC,SAAD,CAAtB,KAAsC,CAAtC,GAA0CU,UAA1C,GAAuDC,cADzD;;EAGA,MAAMG,MAAM,GAAGC,aAAA,CAAaC,UAAb,CAAwBhB,SAAxB,CAAf;;EAEA,IAAIc,MAAM,IAAIA,MAAM,CAACG,QAArB,EAA+B;IAC7B,OAAOH,MAAM,CAACG,QAAd;EACD;;EAED,OAAOJ,QAAP;AACD,CApBM;;;;AAsBA,MAAMK,mBAAmB,GAAIlB,SAAD,IAAgC;EACjE,MAAMe,YAAY,GAAGN,eAAe,CAACT,SAAD,CAApC;EACA,OAAO,IAAAmB,qBAAA,EAAMJ,YAAY,GAAI,2BAAtB,EAAkDK,MAAlD,KAA6D,CAApE;AACD,CAHM"}