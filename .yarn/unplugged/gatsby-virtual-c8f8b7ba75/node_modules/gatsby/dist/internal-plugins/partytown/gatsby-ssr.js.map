{"version":3,"file":"gatsby-ssr.js","names":["onRenderBody","pathname","setHeadComponents","collectedScripts","collectedScriptsByPage","get","length","forwards","getForwards","__html","partytownSnippet","forward","delete"],"sources":["../../../src/internal-plugins/partytown/gatsby-ssr.tsx"],"sourcesContent":["import React from \"react\"\nimport { collectedScriptsByPage } from \"gatsby-script\"\nimport { getForwards } from \"./utils/get-forwards\"\nimport { partytownSnippet } from \"@builder.io/partytown/integration\"\nimport type { GatsbySSR } from \"gatsby\"\n\nexport const onRenderBody: GatsbySSR[`onRenderBody`] = ({\n  pathname,\n  setHeadComponents,\n}) => {\n  const collectedScripts = collectedScriptsByPage.get(pathname)\n\n  if (!collectedScripts?.length) {\n    return\n  }\n\n  const forwards = getForwards(collectedScripts)\n\n  // Adapted from https://github.com/BuilderIO/partytown/blob/main/src/react/snippet.tsx to only include SSR logic\n  setHeadComponents([\n    <script\n      key=\"partytown\"\n      data-partytown=\"\"\n      suppressHydrationWarning={true}\n      dangerouslySetInnerHTML={{\n        __html: `\n          ${partytownSnippet({ forward: forwards })}\n          document.currentScript.dataset.partytown=\"\"\n        `,\n      }}\n    />,\n  ])\n\n  // Clear scripts after we've used them to avoid leaky behavior\n  collectedScriptsByPage.delete(pathname)\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAGO,MAAMA,YAAuC,GAAG,CAAC;EACtDC,QADsD;EAEtDC;AAFsD,CAAD,KAGjD;EACJ,MAAMC,gBAAgB,GAAGC,oCAAA,CAAuBC,GAAvB,CAA2BJ,QAA3B,CAAzB;;EAEA,IAAI,EAACE,gBAAD,aAACA,gBAAD,eAACA,gBAAgB,CAAEG,MAAnB,CAAJ,EAA+B;IAC7B;EACD;;EAED,MAAMC,QAAQ,GAAG,IAAAC,wBAAA,EAAYL,gBAAZ,CAAjB,CAPI,CASJ;;EACAD,iBAAiB,CAAC,cAChB;IACE,GAAG,EAAC,WADN;IAEE,kBAAe,EAFjB;IAGE,wBAAwB,EAAE,IAH5B;IAIE,uBAAuB,EAAE;MACvBO,MAAM,EAAG;AACjB,YAAY,IAAAC,6BAAA,EAAiB;QAAEC,OAAO,EAAEJ;MAAX,CAAjB,CAAwC;AACpD;AACA;IAJ+B;EAJ3B,EADgB,CAAD,CAAjB,CAVI,CAwBJ;;EACAH,oCAAA,CAAuBQ,MAAvB,CAA8BX,QAA9B;AACD,CA7BM"}